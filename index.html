<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DSRT Studio Final Interactive</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { margin:0; font-family:'Segoe UI', sans-serif; background:#0e0e0e; color:white; }
  .canvas { background:#1f1f1f; width:100%; height:60vh; display:flex; align-items:center; justify-content:center; border:2px solid #3b82f6; position:relative; overflow:hidden; }
  .back-bar { background:#111827; padding:0.5rem 1rem; border-bottom:1px solid #3b82f6; display:flex; align-items:center; }
  .bar { background:#1f2937; cursor:pointer; padding:0.5rem 1rem; display:flex; align-items:center; justify-content:space-between; border-top:1px solid #3b82f6; }
  .panel { background:#111827; max-height:0; overflow:hidden; transition:max-height 0.3s ease; }
  .panel.active { max-height:500px; }
  .panel-content { padding:0.5rem 1rem; display:flex; flex-wrap:wrap; gap:0.5rem; }
  .tool { background:#374151; padding:0.5rem 1rem; border-radius:0.375rem; cursor:pointer; flex:1 1 120px; text-align:center; }
  .button { background:#3b82f6; padding:0.5rem 1rem; border-radius:0.375rem; cursor:pointer; }
  input[type=range] { width:100%; }
</style>
</head>
<body>

<!-- Back Bar -->
<div class="back-bar">
  <button onclick="alert('Kembali ke Landing Page')" class="button">Back</button>
</div>

<!-- Canvas -->
<div class="canvas" id="canvas">
  <span>Canvas Preview Area</span>
</div>

<!-- Video Bar -->
<div class="bar" onclick="togglePanel('videoPanel')">
  <span>Video ▼</span>
</div>
<div class="panel" id="videoPanel">
  <div class="panel-content">
    <div class="tool" onclick="trimVideo()">Trim</div>
    <div class="tool" onclick="overlayVideo()">Overlay</div>
    <div class="tool" onclick="beatSync()">Beat Sync</div>
    <div class="tool" onclick="applyVideoFilter()">Filter</div>
    <div class="tool" onclick="showTimeline()">Timeline</div>
    <div class="tool" onclick="manageLayer()">Layer</div>
    <div class="tool" onclick="applyPreset()">Preset</div>
  </div>
</div>

<!-- Manual Tools Bar -->
<div class="bar" onclick="togglePanel('manualPanel')">
  <span>Manual Tools ▼</span>
</div>
<div class="panel" id="manualPanel">
  <div class="panel-content">
    <div class="tool">Color <input type="range" min="0" max="100" value="50" onchange="applyEffect('color', this.value)"></div>
    <div class="tool">Sharpness <input type="range" min="0" max="100" value="50" onchange="applyEffect('sharpness', this.value)"></div>
    <div class="tool">Noise <input type="range" min="0" max="100" value="50" onchange="applyEffect('noise', this.value)"></div>
    <div class="tool">Texture <input type="range" min="0" max="100" value="50" onchange="applyEffect('texture', this.value)"></div>
    <div class="tool" onclick="undo()">Undo</div>
    <div class="tool" onclick="redo()">Redo</div>
  </div>
</div>

<!-- Upload / Download / Audio -->
<div class="bar">
  <label class="tool">
    Upload Image/Video/Audio
    <input type="file" id="uploadFile" style="display:none" onchange="uploadFile(event)">
  </label>
  <button class="tool" onclick="downloadCanvas()">Download</button>
  <button class="tool" onclick="playAudio()">Play Audio</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
let historyStack = [], redoStack = [];

function togglePanel(id){
  const panels = ['videoPanel','manualPanel'];
  panels.forEach(p=>{
    const el=document.getElementById(p);
    if(p===id){ el.classList.toggle('active'); }
    else{ el.classList.remove('active'); }
  });
}

function applyEffect(type, value){
  const canvas = document.getElementById('canvas');
  canvas.style.filter = `brightness(${type==='color'?value+'%':100}) blur(${type==='texture'?value/10+'px':0})`;
  historyStack.push({type,value});
}

function undo(){
  if(historyStack.length){
    const last = historyStack.pop();
    redoStack.push(last);
    document.getElementById('canvas').style.filter = '';
  }
}

function redo(){
  if(redoStack.length){
    const last = redoStack.pop();
    applyEffect(last.type,last.value);
  }
}

function uploadFile(event){
  const file = event.target.files[0];
  if(file){
    const canvas = document.getElementById('canvas');
    if(file.type.startsWith('image')){
      const img = document.createElement('img');
      img.src = URL.createObjectURL(file);
      img.style.maxWidth='100%';
      img.style.maxHeight='100%';
      canvas.innerHTML=''; canvas.appendChild(img);
    } else if(file.type.startsWith('video')){
      const video = document.createElement('video');
      video.src = URL.createObjectURL(file);
      video.controls=true; video.autoplay=true;
      video.style.maxWidth='100%';
      video.style.maxHeight='100%';
      canvas.innerHTML=''; canvas.appendChild(video);
    }
  }
}

function downloadCanvas(){
  html2canvas(document.getElementById('canvas')).then(canvas=>{
    const link=document.createElement('a');
    link.download='dsrt_edit.png';
    link.href=canvas.toDataURL();
    link.click();
  });
}

function playAudio(){ alert('Audio / Beat Sync Play Placeholder'); }
function trimVideo(){ alert('Trim Video Active'); }
function overlayVideo(){ alert('Overlay Video Active'); }
function beatSync(){ alert('Beat Sync Active'); }
function applyVideoFilter(){ alert('Filter Video Active'); }
function showTimeline(){ alert('Timeline Active'); }
function manageLayer(){ alert('Layer Management Active'); }
function applyPreset(){ alert('Template Preset Active'); }
</script>
</body>
</html>
